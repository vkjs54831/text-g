<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>生日</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            margin: 0; 
            padding: 0; 
            height: 100vh; 
            background: #000; 
            overflow: hidden; 
            font-family: "微軟雅黑", sans-serif;
        }
        /* 爱心小窗口样式 */
        .heart-window {
            position: absolute;
            width: 75px;
            height: 30px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #000;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.2s ease;
        }
        /* 生日快乐样式（优化响应式：手机字体稍大+行间距） */
        .birthday-text {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: clamp(40px, 12vw, 80px); /* 手机最小40px（更清晰），电脑最大80px */
            font-weight: 900;
            color: #FFFF00;
            text-shadow: 0 0 12px #FFA500, 0 0 24px #FF6347, 0 0 36px #FF1493;
            z-index: 9999;
            opacity: 0;
            transition: opacity 1.5s ease-in-out;
            text-align: center;
            max-width: 95%; /* 手机端更宽，减少换行压力 */
            line-height: 1.3; /* 行间距优化，不拥挤 */
        }
        /* 电脑版文字（默认显示，保持原样） */
        .desktop-text {
            display: block;
        }
        /* 手机版文字（默认隐藏，优化换行） */
        .mobile-text {
            display: none;
        }
        /* 媒体查询：屏幕宽度<768px（手机）时切换 */
        @media (max-width: 768px) {
            .desktop-text {
                display: none;
            }
            .mobile-text {
                display: block;
            }
            /* 手机端按钮稍小，更适配屏幕 */
            .start-btn {
                padding: 16px 32px;
                font-size: 20px;
            }
        }
        /* 开始按钮样式 */
        .start-btn {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px 40px;
            font-size: 24px;
            font-weight: bold;
            color: #000;
            background: #FFFF00;
            border: none;
            border-radius: 50px;
            box-shadow: 0 0 15px #FFA500, 0 0 30px rgba(255, 165, 0, 0.5);
            cursor: pointer;
            z-index: 10000;
            transition: all 0.3s ease;
        }
        .start-btn:hover {
            background: #FFD700;
            transform: translate(-50%, -50%) scale(1.1);
            box-shadow: 0 0 20px #FFA500, 0 0 40px rgba(255, 165, 0, 0.7);
        }
    </style>
</head>
<body>
    <!-- 生日快乐容器：电脑/手机双版本 -->
    <div class="birthday-text" id="birthdayText">
        <!-- 电脑版（保持原样式：2行） -->
        <span class="desktop-text">生日快樂<br>願妳被世界溫柔以待</span>
        <!-- 手机版（优化换行：3行，“生日快樂”完整一行） -->
        <span class="mobile-text">生日快樂<br>願妳被世界<br>溫柔以待</span>
    </div>
    <!-- 音频代码 -->
    <audio id="birthdayMusic" preload="auto" loop>
      <source src="https://raw.githubusercontent.com/vkjs54831/text-g/main/Goodbye.mp3" type="audio/mpeg">
    </audio>
    <!-- 开始按钮 -->
    <button class="start-btn" id="startBtn">點擊開始！</button>

    <script>
        // 配置参数
        const MESSAGES = [
            "保持好心情", "好好愛自己", "我想你了", "好好吃飯",
            "多喝熱水", "别熬夜", "順順利利", "健健康康",
            "平平安安", "永遠漂亮", "天天開心", "好運連連",
            "溫柔以待", "多穿衣服", "治愈一切", "元氣满满",
            "永遠可愛", "生日快樂", "心想事成", "我永遠愛妳"
        ];
        const HEART_COLORS = [
            "#FFB6C1", "#FFC0CB", "#FFA07A", "#FF69B4", "#FFB9D9",
            "#FFE4E1", "#FFD1DC", "#F0E68C", "#98FB98", "#ADD8E6",
            "#E6E6FA", "#F8C8DC", "#FFEBCD", "#FFA500", "#FF7F50",
            "#DDA0DD", "#F0FFF0", "#FAF0E6", "#FFE4B5", "#FFC1C1"
        ];
        const n = 200;
        const scale = Math.min(window.innerWidth, window.innerHeight) / 40;
        const upOffset = 30;
        const leftOffset = 20;
        const delay = 20;
        const spreadCount = 400;
        const spreadDelay = 20;

        // 存储元素实例
        let heartWins = [];
        let spreadWins = [];
        const birthdayText = document.getElementById("birthdayText");
        const startBtn = document.getElementById("startBtn");
        const birthdayMusic = document.getElementById("birthdayMusic");

        // 创建爱心窗口函数
        function createHeartWindow(x, y, text, type = "heart") {
            const div = document.createElement("div");
            div.className = "heart-window";
            div.textContent = text;
            div.style.left = `${x}px`;
            div.style.top = `${y}px`;
            div.style.backgroundColor = HEART_COLORS[Math.floor(Math.random() * HEART_COLORS.length)];
            document.body.appendChild(div);
            if (type === "heart") heartWins.push(div);
            else spreadWins.push(div);
            return div;
        }

        // 逐步生成爱心
        function generateHeartStepByStep(index = 0, callback) {
            if (index >= n) {
                callback();
                return;
            }
            const t = (index / n) * 2 * Math.PI;
            const x = (window.innerWidth / 2 - leftOffset) + scale * (16 * Math.sin(t) ** 3);
            const y = (window.innerHeight / 2 - upOffset) - scale * (13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t));
            const text = MESSAGES[Math.floor(Math.random() * MESSAGES.length)];
            createHeartWindow(x, y, text, "heart");
            setTimeout(() => {
                generateHeartStepByStep(index + 1, callback);
            }, delay);
        }

        // 逐步满屏扩散
        function spreadFullScreenStepByStep(index = 0, callback) {
            if (index >= spreadCount) {
                callback();
                return;
            }
            const x = Math.random() * (window.innerWidth - 75);
            const y = Math.random() * (window.innerHeight - 30);
            const text = MESSAGES[Math.floor(Math.random() * MESSAGES.length)];
            createHeartWindow(x, y, text, "spread");
            setTimeout(() => {
                spreadFullScreenStepByStep(index + 1, callback);
            }, spreadDelay);
        }

        // 清空所有生成的元素
        function clearAllElements() {
            heartWins.forEach(win => win && win.remove());
            spreadWins.forEach(win => win && win.remove());
            heartWins = [];
            spreadWins = [];
            birthdayText.style.opacity = 0;
        }

        // 显示生日快乐+9秒后重置（含音乐停止）
        function showBirthdayTextAndReset() {
            birthdayText.style.opacity = 1;
            setTimeout(() => {
                birthdayMusic.pause();
                birthdayMusic.currentTime = 0;
                clearAllElements();
                startBtn.style.display = "block";
            }, 9000);
        }

        // 主流程
        function mainAnimation() {
            startBtn.style.display = "none";
            birthdayMusic.play().catch(err => {
                alert("請先點擊空白處 在點擊開始");
                startBtn.style.display = "block";
            });
            generateHeartStepByStep(0, () => {
                setTimeout(() => {
                    heartWins.forEach(win => win && win.remove());
                    heartWins = [];
                    spreadFullScreenStepByStep(0, () => {
                        setTimeout(() => {
                            clearAllElements();
                            setTimeout(() => {
                                showBirthdayTextAndReset();
                            }, 300);
                        }, 1000);
                    });
                }, 2000);
            });
        }

        startBtn.addEventListener("click", mainAnimation);
    </script>
</body>
</html>
